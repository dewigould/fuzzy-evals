"""Experiment 16/02 — configuration constants.

All defaults can be overridden via CLI args in train_math.py / train_code.py / evaluate.py.
"""

from pathlib import Path

# ── Model ────────────────────────────────────────────────────────────────────
MODEL_NAME = "Qwen/Qwen3-30B-A3B-Base"
LORA_RANK = 32

# ── Inference ────────────────────────────────────────────────────────────────
INFERENCE_MAX_TOKENS = 4096

# ── Training ─────────────────────────────────────────────────────────────────
TRAIN_MAX_LENGTH = 4096
TRAIN_LR = 2e-4
TRAIN_SAMPLES = 25_000    # total training examples
TRAIN_BATCH_SIZE = 50     # → 400 steps at default
TRAIN_SCHEDULE = "cosine"
SAVE_EVERY = 100          # every 5K samples (100 steps × 50 batch_size)
EVAL_EVERY = 100

# ── Eval sweep ───────────────────────────────────────────────────────────────
EVAL_DATASETS = ["math_500", "aime", "humanevalplus", "mbppplus"]
EVAL_CONCURRENCY = 10

# ── Paths ────────────────────────────────────────────────────────────────────
EXPERIMENT_DIR = Path(__file__).parent
RESULTS_DIR = EXPERIMENT_DIR / "results"
TRAINING_DIR = EXPERIMENT_DIR / "training_runs"

# Filtered data (generated by parent distillation/ scripts)
DISTILLATION_DIR = EXPERIMENT_DIR.parent
FILTERED_MATH_DATA = DISTILLATION_DIR / "filtered_data" / "clean.jsonl"
FILTERED_CODE_DATA = DISTILLATION_DIR / "filtered_data_kodcode" / "clean.jsonl"
